{"version":3,"sources":["hoc/WithAuth.js","hoc/IfAuth.js","hoc/IfNotAuth.js","components/NavBar/NavBar.js","pages/HomePage.js","pages/LoginPage.js","pages/SignupPage.js","pages/LogoutPage.js","hoc/PrivateRoute.js","hoc/UnPrivateRoute.js","App.js","middleware/authService.js","index.js"],"names":["storageName","withAuth","ComposedComponent","props","useState","client_id","setClient_id","token","setToken","refresh_token","setRefresh_token","ready","setReady","login","useCallback","localStorage","setItem","JSON","stringify","logout","removeItem","useEffect","data","parse","getItem","console","log","user","authState","children","rest","React","Children","map","child","cloneElement","NavBar","Navbar","collapseOnSelect","expand","bg","variant","to","className","Toggle","aria-controls","Collapse","Nav","exact","activeClassName","HomePage","Container","WithAuth","email","setEmail","password","setPassword","a","request","username","axios","post","response","status","access","refresh","Form","Group","Label","Control","type","placeholder","onChange","event","target","value","Button","onClick","SignupPage","invited","setInvited","name","setName","surname","setSurname","signup","invited_by","country_key","phone","LogoutPage","component","render","location","pathname","state","from","App","path","LoginPage","AuthServiceMiddleware","this","config","getAuthFromStorage","headers","err","refreshAccessToken","then","setAuthInStorage","catch","error","clearAuthInStorage","Service","register","app","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.b360a26a.chunk.js","sourcesContent":["import React, {useCallback, useEffect, useState} from 'react'\n\nconst storageName = 'auth'\n\nconst withAuth = ComposedComponent => {\n  return ((props) => {\n    const [client_id, setClient_id] = useState(null)\n    const [token, setToken] = useState(null)\n    const [refresh_token, setRefresh_token] = useState(null)\n    const [ready, setReady] = useState(false)\n\n    const login = useCallback((client_id, token, refresh_token) => {\n      setClient_id(client_id)\n      setToken(token)\n      setRefresh_token(refresh_token)\n\n      localStorage.setItem(storageName,\n        JSON.stringify({\n          client_id: client_id,\n          token: token,\n          refresh_token: refresh_token\n        }))\n    }, [])\n\n    const logout = useCallback(() => {\n      setClient_id(null)\n      setToken(null)\n      setRefresh_token(null)\n      localStorage.removeItem(storageName)\n    }, [])\n\n    useEffect(() => {\n      const data = JSON.parse(localStorage.getItem(storageName))\n      console.log('withAuth useEffect', data)\n\n      if (data && data.token) {\n        login(data.client_id, data.token, data.refresh_token)\n      }\n      setReady(true)\n    }, [])\n\n    const user = {\n      authState: !!token,\n      client_id: client_id,\n      token: token,\n      refresh_token: refresh_token,\n      ready: ready,\n      login: login,\n      logout: logout\n    }\n\n    console.log('withAuth user', user)\n\n    return <ComposedComponent user={user} {...props}/>\n  })\n}\n\nexport default withAuth\n","import React from 'react'\nimport withAuth from './WithAuth'\n\nconst IfAuth = (props) => {\n  const {user, children, ...rest} = props\n  console.log('IfAuth', user.authState)\n\n  if (user.authState)\n    return React.Children.map(children, (child) => {\n        return React.cloneElement(child, {...rest})\n      }\n    )\n  else\n    return null\n}\n\nexport default withAuth(IfAuth)\n","import React from 'react'\nimport withAuth from './WithAuth'\n\nconst IfNotAuth = (props) => {\n  const {user, children, ...rest} = props\n  console.log('IfNotAuth', !user.authState)\n\n  if (!user.authState)\n    return React.Children.map(children, (child) => {\n        return React.cloneElement(child, {...rest})\n      }\n    )\n  else\n    return null\n}\n\nexport default withAuth(IfNotAuth)\n","import React from 'react'\nimport {Link, NavLink} from 'react-router-dom'\nimport {Navbar, Nav, NavDropdown, Container} from 'react-bootstrap'\nimport IfAuth from '../../hoc/IfAuth'\nimport IfNotAuth from '../../hoc/IfNotAuth'\n\nconst NavBar = props => {\n  return (\n    <>\n      <Navbar collapseOnSelect expand=\"md\" bg=\"dark\" variant=\"dark\">\n        <Link to=\"/\" className=\"navbar-brand\">\n          Vision web test\n        </Link>\n        <Navbar.Toggle aria-controls=\"responsive-navbar-nav\"/>\n        <Navbar.Collapse>\n          <Nav className=\"mr-auto\">\n            <IfNotAuth>\n              <NavLink exact to=\"/signup\" activeClassName=\"active\" className=\"nav-link\">Sign Up</NavLink>\n              <NavLink exact to=\"/login\" activeClassName=\"active\" className=\"nav-link\">Login</NavLink>\n            </IfNotAuth>\n\n            <IfAuth>\n              <NavLink exact to=\"/\" activeClassName=\"active\" className=\"nav-link\">Home</NavLink>\n              <NavLink exact to=\"/logout\" activeClassName=\"active\" className=\"nav-link\">Logout</NavLink>\n            </IfAuth>\n          </Nav>\n\n        </Navbar.Collapse>\n      </Navbar>\n    </>\n  )\n}\n\nexport default NavBar\n","import React from 'react'\nimport {Container} from 'react-bootstrap'\n\nconst HomePage = props => {\n  return (\n    <Container className=\"my-2\">\n      <h2>Home page</h2>\n    </Container>\n  )\n}\n\nexport default HomePage\n","import React, {useState} from 'react'\nimport {Button, Container, Form} from 'react-bootstrap'\nimport  {Link} from 'react-router-dom'\nimport axios from 'axios'\nimport WithAuth from '../hoc/WithAuth'\n\nconst LoginPage = props => {\n  const {user} = props\n  const [email, setEmail] = useState(null)\n  const [password, setPassword] = useState(null)\n\n  const login = async () => {\n    const request = {\n      username: email,\n      password\n    }\n\n    console.log('login request', request)\n    const response = await axios.post('http://erp.apptrix.ru/api/clients/token/', request)\n\n    if(response.status === 200){\n      const data = response.data\n      user.login(data.client_id, data.access, data.refresh)\n    }\n    console.log('login response', response)\n  }\n\n  return (\n    <Container className=\"col-md-6 mx-auto my-2\">\n      <h2>Please login:</h2>\n      <Form>\n        <Form.Group>\n          <Form.Label>Email address</Form.Label>\n          <Form.Control type=\"email\" placeholder=\"Enter email\"\n                        onChange={event => setEmail(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Password</Form.Label>\n          <Form.Control type=\"password\" placeholder=\"Password\"\n                        onChange={event => setPassword(event.target.value)}/>\n        </Form.Group>\n\n        <Button variant=\"primary\" type=\"button\" className=\"px-5\"\n                onClick={login}>\n          Login...\n        </Button>\n\n        <Link to=\"/signup\" className=\"btn btn-info px-5 ml-2\">Sign Up if unregistered</Link>\n      </Form>\n    </Container>\n  )\n}\n\nexport default WithAuth(LoginPage)\n\n","import React, {useState} from 'react'\nimport {Button, Container, Form} from 'react-bootstrap'\nimport {Link} from 'react-router-dom'\nimport axios from 'axios'\n\nconst SignupPage = props => {\n  const [email, setEmail] = useState(null)\n  const [password, setPassword] = useState(null)\n  const [invited, setInvited] = useState(null)\n  const [name, setName] = useState(null)\n  const [surname, setSurname] = useState(null)\n\n  const signup = async () => {\n    const request = {\n      user: {email, password},\n      invited_by: invited,\n      name,\n      surname,\n      country_key: 'RU',\n      phone: '+78003002010'\n    }\n\n    console.log('signup', request)\n\n    const response = await axios.post('http://erp.apptrix.ru/api/clients/create/', request)\n  }\n\n\n  return (\n    <Container className=\"col-md-6 mx-auto my-2\">\n      <h2>Please sign up:</h2>\n      <Form>\n        <Form.Group>\n          <Form.Label>Name</Form.Label>\n          <Form.Control type=\"text\" name=\"fname\" placeholder=\"Name\"\n                        onChange={event => setName(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Surname</Form.Label>\n          <Form.Control type=\"text\" name=\"lname\" placeholder=\"Surname\"\n                        onChange={event => setSurname(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Invited by </Form.Label>\n          <Form.Control type=\"text\" placeholder=\"Invited by\"\n                        onChange={event => setInvited(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Email address</Form.Label>\n          <Form.Control type=\"email\" placeholder=\"Enter email\"\n                        onChange={event => setEmail(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Password</Form.Label>\n          <Form.Control type=\"password\" placeholder=\"Password\"\n                        onChange={event => setPassword(event.target.value)}/>\n        </Form.Group>\n\n        <Button variant=\"primary\" type=\"button\" className=\"px-5\"\n                onClick={signup}>\n          Sign Up...\n        </Button>\n\n        <Link to=\"/login\" className=\"btn btn-info px-5 ml-2\">Login if registered</Link>\n      </Form>\n    </Container>\n  )\n}\n\nexport default SignupPage\n","import React, {useEffect} from 'react'\n\nconst LogoutPage = props => {\n\n  useEffect(() => {\n\n    // do logout\n  }, [])\n\n\n  return (\n    <>\n      logout\n    </>\n  )\n}\n\nexport default LogoutPage\n","import React from 'react'\nimport {Route, Redirect} from 'react-router-dom'\nimport withAuth from './WithAuth'\n\nconst PrivateRoute = (props) => {\n    const {user, component, ...rest} = props\n\n    console.log('PrivateRoute', user.authState)\n\n    if (user.authState)\n        return (\n            <Route {...rest} component={component}/>\n        )\n    else\n        return (\n            <Route\n                {...rest}\n                render={\n                    ({location}) =>\n                        <Redirect\n                            to={\n                                {\n                                    pathname: '/login',\n                                    state: {from: location}\n                                }}\n                        />\n                }\n            />\n        )\n}\n\nexport default withAuth(PrivateRoute)\n\n","import React from 'react'\nimport {Route, Redirect} from 'react-router-dom'\nimport withAuth from './WithAuth'\n\nconst UnPrivateRoute = (props) => {\n    const {user, component, ...rest} = props\n\n    if (!user.authState)\n        return (\n            <Route {...rest} component={component}/>\n        )\n    else\n        return (\n            <Route\n                {...rest}\n                render={\n                    ({location}) =>\n                        <Redirect\n                            to={\n                                {\n                                    pathname: '/home',\n                                    state: {from: location}\n                                }}\n                        />\n                }\n            />\n        )\n}\n\nexport default withAuth(UnPrivateRoute)\n\n","import './App.scss'\nimport React from 'react'\nimport {Switch, Route} from 'react-router-dom'\nimport NavBar from './components/NavBar/NavBar'\nimport HomePage from './pages/HomePage'\nimport LoginPage from './pages/LoginPage'\nimport SignupPage from './pages/SignupPage'\nimport LogoutPage from './pages/LogoutPage'\nimport PrivateRoute from './hoc/PrivateRoute'\nimport UnPrivateRoute from \"./hoc/UnPrivateRoute\";\n\nfunction App() {\n\n  return (\n    <>\n      <NavBar/>\n      <Switch>\n        <UnPrivateRoute path=\"/login\" component={LoginPage}/>\n        <UnPrivateRoute path=\"/signup\" component={SignupPage}/>\n        <PrivateRoute path=\"/\" component={HomePage}/>\n        <PrivateRoute path=\"/logout\" component={LogoutPage}/>\n      </Switch>\n    </>\n  )\n}\n\nexport default App\n","const storageName = 'auth'\n\nclass AuthServiceMiddleware {\n  constructor() {\n    this.storageName = storageName\n  }\n\n  onRequest(config) {\n    const data = getAuthFromStorage()\n    if (data && data.token) {\n      console.log('Axios_onRequest middleware with Bearer Token')\n\n      return {\n        ...config,\n        headers: {\n          ...config.headers,\n          'Authorization': `Bearer ${data.token}`\n        }\n      }\n\n    } else {\n      console.log('Axios_onRequest middleware NO Bearer Token')\n      return config\n    }\n  }\n\n  onResponseError(err) {\n    if (err.response.status === 401) {\n      return refreshAccessToken()\n        .then((data) => {\n          setAuthInStorage(data)\n          console.log('Refresh token success')\n        })\n        .catch((error) => {\n          clearAuthInStorage()\n          console.log('Refresh login error: ', error)\n          throw error\n        })\n    }\n    throw err\n  }\n\n}\n\nconst refreshAccessToken = async () => {\n\n  // const data = {\n  //   client_id: client_id,\n  //   token: token,\n  //   refresh_token: refresh_token\n  // }\n\n}\n\nconst getAuthFromStorage = () => {\n  return JSON.parse(localStorage.getItem(storageName))\n}\n\nconst setAuthInStorage = (data) => {\n  localStorage.setItem(storageName,\n    JSON.stringify(data))\n}\n\nconst clearAuthInStorage = () => {\n  localStorage.removeItem(storageName)\n}\n\n\nexport {AuthServiceMiddleware, refreshAccessToken}\n\n\n\n\n\n\n\n\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport {BrowserRouter as Router} from 'react-router-dom'\nimport axios from 'axios'\nimport {Service} from 'axios-middleware'\nimport {AuthServiceMiddleware} from './middleware/authService'\n\nconst service = new Service(axios)\n\nservice.register([\n  new AuthServiceMiddleware()\n])\n\n\nconst app = (\n  <Router>\n    <App/>\n  </Router>\n)\n\nReactDOM.render(app, document.getElementById('root'))\n\n"],"sourceRoot":""}