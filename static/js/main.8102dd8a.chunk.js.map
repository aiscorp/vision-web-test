{"version":3,"sources":["context/authContext.js","hoc/WithAuth.js","hoc/IfAuth.js","hoc/IfNotAuth.js","components/NavBar/NavBar.js","pages/HomePage.js","pages/LoginPage.js","pages/SignupPage.js","pages/LogoutPage.js","hoc/PrivateRoute.js","hoc/UnPrivateRoute.js","context/authProvider.js","App.js","middleware/authService.js","index.js"],"names":["AuthContext","React","createContext","withAuth","ComposedComponent","props","useContext","user","login","updateUser","logout","newUser","children","rest","authState","Children","map","child","cloneElement","NavBar","Navbar","collapseOnSelect","expand","bg","variant","to","className","Toggle","aria-controls","Collapse","Nav","exact","activeClassName","useState","info","setInfo","useEffect","axios","get","client_id","then","res","status","data","console","log","catch","e","Container","userInfo","src","avatar","style","height","alt","name","surname","email","phone","invited_by","WithAuth","setEmail","password","setPassword","a","request","username","post","response","access","refresh","pathname","Form","Group","Label","Control","type","placeholder","onChange","event","target","value","Button","onClick","SignupPage","invited","setInvited","setName","setSurname","signup","country_key","push","component","render","location","state","from","storageName","AuthProvider","JSON","parse","localStorage","getItem","token","refresh_token","autoLogin","setUser","useCallback","setItem","stringify","removeItem","Provider","App","path","LoginPage","LogoutPage","HomePage","AuthServiceMiddleware","this","config","getAuthFromStorage","headers","err","refreshAccessToken","setAuthInStorage","error","clearAuthInStorage","Service","register","app","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.8102dd8a.chunk.js","sourcesContent":["import React, {useContext} from 'react'\n\nexport const AuthContext = React.createContext()\n\nexport const useAuth = () => useContext(AuthContext)\n\n","import React from 'react'\n\nimport {useAuth} from '../context/authContext'\n\nconst withAuth = ComposedComponent => {\n    return ((props) => {\n        const {user, updateUser, login, logout} = useAuth()\n\n          const newUser = {\n                ...user,\n                login: login,\n                logout: logout\n            }\n\n        return <ComposedComponent user={newUser} {...props}/>\n    })\n}\n\nexport default withAuth\n","import React from 'react'\nimport withAuth from './WithAuth'\n\nconst IfAuth = (props) => {\n  const {user, children, ...rest} = props\n\n  if (user.authState)\n    return React.Children.map(children, (child) => {\n        return React.cloneElement(child, {...rest})\n      }\n    )\n  else\n    return null\n}\n\nexport default withAuth(IfAuth)\n","import React from 'react'\nimport withAuth from './WithAuth'\n\nconst IfNotAuth = (props) => {\n  const {user, children, ...rest} = props\n\n  if (!user.authState)\n    return React.Children.map(children, (child) => {\n        return React.cloneElement(child, {...rest})\n      }\n    )\n  else\n    return null\n}\n\nexport default withAuth(IfNotAuth)\n","import React from 'react'\nimport {Link, NavLink} from 'react-router-dom'\nimport {Navbar, Nav} from 'react-bootstrap'\nimport IfAuth from '../../hoc/IfAuth'\nimport IfNotAuth from '../../hoc/IfNotAuth'\n\nconst NavBar = props => {\n  return (\n    <>\n      <Navbar collapseOnSelect expand=\"md\" bg=\"dark\" variant=\"dark\">\n        <Link to=\"/\" className=\"navbar-brand\">\n          Vision web test\n        </Link>\n        <Navbar.Toggle aria-controls=\"responsive-navbar-nav\"/>\n        <Navbar.Collapse>\n          <Nav className=\"mr-auto\">\n            <IfNotAuth>\n              <NavLink exact to=\"/signup\" activeClassName=\"active\" className=\"nav-link\">Sign Up</NavLink>\n              <NavLink exact to=\"/login\" activeClassName=\"active\" className=\"nav-link\">Login</NavLink>\n            </IfNotAuth>\n\n            <IfAuth>\n              <NavLink exact to=\"/\" activeClassName=\"active\" className=\"nav-link\">Home</NavLink>\n              <NavLink exact to=\"/logout\" activeClassName=\"active\" className=\"nav-link\">Logout</NavLink>\n            </IfAuth>\n          </Nav>\n\n        </Navbar.Collapse>\n      </Navbar>\n    </>\n  )\n}\n\nexport default NavBar\n","import React, {useEffect, useState} from 'react'\nimport {Container} from 'react-bootstrap'\nimport axios from \"axios\";\nimport withAuth from \"../hoc/WithAuth\";\n\nconst HomePage = props => {\n    const {user} = props\n    const [info, setInfo] = useState()\n\n    useEffect(() => {\n        axios.get(`http://erp.apptrix.ru/api/clients/${user.client_id}/`)\n            .then(res => {\n                if (res.status === 200) {\n                    const data = res.data\n                    setInfo(data)\n                }\n                console.log('response', res)\n            })\n            .catch(e => console.log('error', e))\n    }, [])\n\n    return (\n        <Container className=\"my-2\">\n            <h2>Home page</h2>\n            {!!info && userInfo(info)}\n        </Container>\n    )\n}\n\nexport default withAuth(HomePage)\n\nconst userInfo = (info) => (\n    <>\n        <img src={info.avatar} style={{height: '128px'}} alt='avatar'/>\n        <h3>{`Hello ${info.name} ${info.surname}!`}</h3>\n        <p>Hear is information stored in your account:</p>\n        <p>{`Name: ${info.name}`}</p>\n        <p>{`Surname: ${info.surname}`}</p>\n        <p>{`Email: ${info.email}`}</p>\n        <p>{`Phone: ${info.phone}`}</p>\n        <p>{`Client ID: ${info.client_id}`}</p>\n        <p>{`Invited by: ${info.invited_by.name} ${info.invited_by.surname}`}</p>\n    </>\n)","import React, {useState} from 'react'\nimport {Button, Container, Form} from 'react-bootstrap'\nimport {Link, Redirect} from 'react-router-dom'\nimport axios from 'axios'\nimport WithAuth from '../hoc/WithAuth'\n\nconst LoginPage = props => {\n    const {user} = props\n    const [email, setEmail] = useState(null)\n    const [password, setPassword] = useState(null)\n\n    const login = async () => {\n        const request = {\n            username: email,\n            password\n        }\n\n        const response = await axios.post('http://erp.apptrix.ru/api/clients/token/', request)\n\n        if (response.status === 200) {\n            const data = response.data\n            user.login(data.client_id, data.access, data.refresh)\n        }\n    }\n\n\n    if (user.authState) {\n        return <Redirect to={{pathname: '/'}}/>\n    } else {\n        return (\n            <Container className=\"col-md-6 mx-auto my-2\">\n                <h2>Please login:</h2>\n                <Form>\n                    <Form.Group>\n                        <Form.Label>Email address</Form.Label>\n                        <Form.Control type=\"email\" placeholder=\"Enter email\"\n                                      onChange={event => setEmail(event.target.value)}/>\n                    </Form.Group>\n\n                    <Form.Group>\n                        <Form.Label>Password</Form.Label>\n                        <Form.Control type=\"password\" placeholder=\"Password\"\n                                      onChange={event => setPassword(event.target.value)}/>\n                    </Form.Group>\n\n                    <Button variant=\"primary\" type=\"button\" className=\"px-5\"\n                            onClick={login}>\n                        Login...\n                    </Button>\n\n                    <Link to=\"/signup\" className=\"btn btn-info px-5 ml-2\">Sign Up if unregistered</Link>\n                </Form>\n            </Container>\n        )\n    }\n}\n\nexport default WithAuth(LoginPage)\n\n","import React, {useState} from 'react'\nimport {Button, Container, Form} from 'react-bootstrap'\nimport {Link} from 'react-router-dom'\nimport axios from 'axios'\n\nconst SignupPage = props => {\n  const [email, setEmail] = useState(null)\n  const [password, setPassword] = useState(null)\n  const [invited, setInvited] = useState(null)\n  const [name, setName] = useState(null)\n  const [surname, setSurname] = useState(null)\n\n  const signup = async () => {\n    const request = {\n      user: {email, password},\n      invited_by: invited,\n      name,\n      surname,\n      country_key: 'RU',\n      phone: '+78003002010'\n    }\n\n    console.log('signup', request)\n\n    const response = await axios.post('http://erp.apptrix.ru/api/clients/create/', request)\n  }\n\n\n  return (\n    <Container className=\"col-md-6 mx-auto my-2\">\n      <h2>Please sign up:</h2>\n      <Form>\n        <Form.Group>\n          <Form.Label>Name</Form.Label>\n          <Form.Control type=\"text\" name=\"fname\" placeholder=\"Name\"\n                        onChange={event => setName(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Surname</Form.Label>\n          <Form.Control type=\"text\" name=\"lname\" placeholder=\"Surname\"\n                        onChange={event => setSurname(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Invited by </Form.Label>\n          <Form.Control type=\"text\" placeholder=\"Invited by\"\n                        onChange={event => setInvited(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Email address</Form.Label>\n          <Form.Control type=\"email\" placeholder=\"Enter email\"\n                        onChange={event => setEmail(event.target.value)}/>\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Label>Password</Form.Label>\n          <Form.Control type=\"password\" placeholder=\"Password\"\n                        onChange={event => setPassword(event.target.value)}/>\n        </Form.Group>\n\n        <Button variant=\"primary\" type=\"button\" className=\"px-5\"\n                onClick={signup}>\n          Sign Up...\n        </Button>\n\n        <Link to=\"/login\" className=\"btn btn-info px-5 ml-2\">Login if registered</Link>\n      </Form>\n    </Container>\n  )\n}\n\nexport default SignupPage\n","import React, {useEffect} from 'react'\nimport WithAuth from \"../hoc/WithAuth\";\nimport {Redirect} from \"react-router-dom\";\n\nconst LogoutPage = props => {\n    const {user} = props\n\n    useEffect(() => {\n        user.logout()\n        // do logout\n    }, [])\n\n    if (user.authState) {\n        return null\n    } else {\n        return <Redirect push to={{pathname: '/login'}}/>\n    }\n}\n\nexport default WithAuth(LogoutPage)\n","import React from 'react'\nimport {Route, Redirect} from 'react-router-dom'\nimport withAuth from './WithAuth'\n\nconst PrivateRoute = (props) => {\n    const {user, component, ...rest} = props\n\n    if (user.authState)\n        return (\n            <Route {...rest} component={component}/>\n        )\n    else\n        return (\n            <Route\n                {...rest}\n                render={\n                    ({location}) =>\n                        <Redirect\n                            to={\n                                {\n                                    pathname: '/login',\n                                    state: {from: location}\n                                }}\n                        />\n                }\n            />\n        )\n}\n\n// export default PrivateRoute\nexport default withAuth(PrivateRoute)\n\n","import React from 'react'\nimport {Route, Redirect} from 'react-router-dom'\nimport withAuth from './WithAuth'\n\nconst UnPrivateRoute = (props) => {\n    const {user, component, ...rest} = props\n\n    if (!user.authState)\n        return (\n            <Route {...rest} component={component}/>\n        )\n    else\n        return (\n            <Route\n                {...rest}\n                render={\n                    ({location}) =>\n                        <Redirect\n                            to={\n                                {\n                                    pathname: '/',\n                                    state: {from: location}\n                                }}\n                        />\n                }\n            />\n        )\n}\n\n// export default UnPrivateRoute\nexport default withAuth(UnPrivateRoute)\n\n","import {AuthContext} from \"./authContext\"\nimport React, {useCallback, useEffect, useState} from \"react\"\n\nconst storageName = 'auth'\n\nexport const AuthProvider = ({children}) => {\n\n    const autoLogin = () => {\n        const data = JSON.parse(localStorage.getItem(storageName))\n        let newUser\n        if (data && data.token) {\n            newUser = {\n                authState: !!data.token,\n                client_id: data.client_id,\n                token: data.token,\n                refresh_token: data.refresh_token\n            }\n        } else {\n            newUser = {\n                authState: false\n            }\n        }\n        return newUser\n    }\n\n    const [user, setUser] = useState(() => autoLogin())\n\n    const updateUser = (user) => setUser(user)\n\n    const login = useCallback((client_id, token, refresh_token) => {\n        const newUser = {\n            authState: !!token,\n            client_id: client_id,\n            token: token,\n            refresh_token: refresh_token\n        }\n\n        localStorage.setItem(storageName,\n            JSON.stringify({\n                client_id: client_id,\n                token: token,\n                refresh_token: refresh_token\n            }))\n\n        setUser(newUser)\n    }, [])\n\n    const logout = useCallback(() => {\n        localStorage.removeItem(storageName)\n        setUser({authState: false})\n    }, [])\n\n    return (\n        <AuthContext.Provider value={{user, updateUser, login, logout}}>\n            {children}\n        </AuthContext.Provider>\n    )\n}\n","import './App.scss'\nimport React from 'react'\nimport {Switch, Route, Redirect} from 'react-router-dom'\nimport NavBar from './components/NavBar/NavBar'\nimport HomePage from './pages/HomePage'\nimport LoginPage from './pages/LoginPage'\nimport SignupPage from './pages/SignupPage'\nimport LogoutPage from './pages/LogoutPage'\nimport PrivateRoute from \"./hoc/PrivateRoute\"\nimport UnPrivateRoute from \"./hoc/UnPrivateRoute\"\nimport {AuthProvider} from \"./context/authProvider\"\n\n\nfunction App() {\n\n    return (\n        <AuthProvider>\n            <NavBar/>\n            <Switch>\n                <UnPrivateRoute path=\"/login\" component={LoginPage}/>\n                <UnPrivateRoute path=\"/signup\" component={SignupPage}/>\n\n                <PrivateRoute path=\"/logout\" component={LogoutPage}/>\n                <PrivateRoute path=\"/\" component={HomePage}/>\n            </Switch>\n        </AuthProvider>\n    )\n}\n\nexport default App\n","import axios from \"axios\";\n\nconst storageName = 'auth'\n\nclass AuthServiceMiddleware {\n    constructor() {\n        this.storageName = storageName\n    }\n\n    onRequest(config) {\n        const data = getAuthFromStorage()\n        if (data && data.token) {\n            console.log('Axios_onRequest middleware with Bearer Token')\n\n            return {\n                ...config,\n                headers: {\n                    ...config.headers,\n                    'Authorization': `Bearer ${data.token}`\n                }\n            }\n\n        } else {\n            console.log('Axios_onRequest middleware NO Bearer Token')\n            return config\n        }\n    }\n\n    onResponseError(err) {\n        if (err.response.status === 401) {\n            return refreshAccessToken()\n                .then((data) => {\n                    setAuthInStorage(data)\n                    console.log('Refresh token success')\n                })\n                .catch((error) => {\n                    clearAuthInStorage()\n                    console.log('Refresh login error: ', error)\n                    throw error\n                })\n        }\n        throw err\n    }\n\n}\n\nconst refreshAccessToken = async () => {\n    return axios.get(`http://erp.apptrix.ru/api/clients/token/refresh/`)\n        .then(res => {\n            if (res.status === 200) {\n                const data = res.data\n                console.log('refreshAccessToken data', data)\n                return data\n            }\n            console.log('refreshAccessToken res', res)\n        })\n        .catch(e => {\n            console.log('error', e)\n            return e\n        })\n}\n\nconst getAuthFromStorage = () => {\n    return JSON.parse(localStorage.getItem(storageName))\n}\n\nconst setAuthInStorage = (data) => {\n    localStorage.setItem(storageName,\n        JSON.stringify(data))\n}\n\nconst clearAuthInStorage = () => {\n    localStorage.removeItem(storageName)\n}\n\n\nexport {AuthServiceMiddleware, refreshAccessToken}\n\n\n\n\n\n\n\n\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport {BrowserRouter as Router} from 'react-router-dom'\nimport axios from 'axios'\nimport {Service} from 'axios-middleware'\nimport {AuthServiceMiddleware} from './middleware/authService'\n\nconst service = new Service(axios)\n\nservice.register([\n  new AuthServiceMiddleware()\n])\n\n\nconst app = (\n  <Router>\n    <App/>\n  </Router>\n)\n\nReactDOM.render(app, document.getElementById('root'))\n\n"],"sourceRoot":""}